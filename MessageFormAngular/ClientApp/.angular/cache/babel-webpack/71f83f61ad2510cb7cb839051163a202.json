{"ast":null,"code":"import _classCallCheck from \"D:/YandexDisk/Projects/NetCore/MessageFormAngular/MessageFormAngular/ClientApp/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:/YandexDisk/Projects/NetCore/MessageFormAngular/MessageFormAngular/ClientApp/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { DataService } from './data.service';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { Contact } from './contact';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./data.service\";\n\nfunction MessageFormComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1, \" \\u041D\\u0435 \\u0443\\u043A\\u0430\\u0437\\u0430\\u043D\\u043E \\u0438\\u043C\\u044F \\u043A\\u043E\\u043D\\u0442\\u0430\\u043A\\u0442\\u0430 \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MessageFormComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1, \" \\u041D\\u0435\\u043A\\u043E\\u0440\\u0440\\u0435\\u043A\\u0442\\u043D\\u044B\\u0439 email \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MessageFormComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1, \" \\u041D\\u0435\\u043A\\u043E\\u0440\\u0440\\u0435\\u043A\\u0442\\u043D\\u044B\\u0439 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430 \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MessageFormComponent_option_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var topic_r5 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", topic_r5.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(topic_r5.title);\n  }\n}\n\nfunction MessageFormComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1, \" \\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435 \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport var MessageFormComponent = /*#__PURE__*/(function () {\n  var MessageFormComponent = /*#__PURE__*/function () {\n    function MessageFormComponent(dataService) {\n      _classCallCheck(this, MessageFormComponent);\n\n      this.dataService = dataService;\n      this.contact = new Contact();\n      this.msgForm = new FormGroup({\n        \"contactName\": new FormControl(\"\", Validators.required),\n        \"contactEmail\": new FormControl(\"\", [Validators.required, Validators.email]),\n        \"phoneNumber\": new FormControl(\"\", [Validators.required, Validators.pattern(\"[0-9]{10}\")]),\n        \"message\": new FormControl(\"\", Validators.required)\n      });\n    }\n\n    _createClass(MessageFormComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        this.loadTopics(); //this.loadMessages();\n\n        this.loadContacts();\n      }\n    }, {\n      key: \"loadTopics\",\n      value: function loadTopics() {\n        var _this = this;\n\n        this.dataService.getTopics().subscribe(function (data) {\n          return _this.topics = data;\n        });\n      }\n    }, {\n      key: \"loadMessages\",\n      value: function loadMessages() {\n        var _this2 = this;\n\n        this.dataService.getMessages().subscribe(function (data) {\n          return _this2.messages = data;\n        });\n      }\n    }, {\n      key: \"loadContacts\",\n      value: function loadContacts() {\n        var _this3 = this;\n\n        this.dataService.getContacts().subscribe(function (data) {\n          return _this3.contacts = data;\n        });\n      }\n    }, {\n      key: \"save\",\n      value: function save() {\n        var _this4 = this;\n\n        // Поиск индекса элемента с такими же email и телефоном\n        this.index = this.contacts.findIndex(function (c) {\n          return c.email === _this4.contact.email && c.phoneNumber === _this4.contact.phoneNumber;\n        }); // Если отсутствуют, добавляем в базу\n\n        if (this.index === -1) {\n          this.dataService.createContact(this.contact).subscribe(function (data) {\n            return _this4.contacts.push(data);\n          });\n        } // Добавление сообщения\n\n      }\n    }]);\n\n    return MessageFormComponent;\n  }();\n\n  MessageFormComponent.ɵfac = function MessageFormComponent_Factory(t) {\n    return new (t || MessageFormComponent)(i0.ɵɵdirectiveInject(i1.DataService));\n  };\n\n  MessageFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MessageFormComponent,\n    selectors: [[\"ng-component\"]],\n    features: [i0.ɵɵProvidersFeature([DataService])],\n    decls: 44,\n    vars: 11,\n    consts: [[\"novalidate\", \"\", 1, \"container\", \"m-3\", 3, \"formGroup\", \"ngSubmit\"], [1, \"row\", \"mb-3\", \"form-group\"], [1, \"col-2\"], [1, \"col-form-label\", \"fw-bold\"], [1, \"col\"], [\"name\", \"contactName\", \"formControlName\", \"contactName\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"name\", \"contactEmail\", \"formControlName\", \"contactEmail\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"phoneNumber\", \"formControlName\", \"phoneNumber\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"topic\", 1, \"form-select\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"message\", \"rows\", \"5\", \"formControlName\", \"message\", 1, \"form-control\"], [1, \"form-group\"], [1, \"btn\", \"btn-success\", 3, \"disabled\"], [\"routerLink\", \"/message/1/\"], [1, \"alert\", \"alert-danger\"], [3, \"value\"]],\n    template: function MessageFormComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function MessageFormComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.submit();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"label\", 3);\n        i0.ɵɵtext(4, \"\\u0412\\u0430\\u0448\\u0435 \\u0438\\u043C\\u044F:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 4);\n        i0.ɵɵelementStart(6, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function MessageFormComponent_Template_input_ngModelChange_6_listener($event) {\n          return ctx.contact.name = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(7, MessageFormComponent_div_7_Template, 2, 0, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 1);\n        i0.ɵɵelementStart(9, \"div\", 2);\n        i0.ɵɵelementStart(10, \"label\", 3);\n        i0.ɵɵtext(11, \"\\u0412\\u0430\\u0448 Email:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 4);\n        i0.ɵɵelementStart(13, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function MessageFormComponent_Template_input_ngModelChange_13_listener($event) {\n          return ctx.contact.email = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, MessageFormComponent_div_14_Template, 2, 0, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 1);\n        i0.ɵɵelementStart(16, \"div\", 2);\n        i0.ɵɵelementStart(17, \"label\", 3);\n        i0.ɵɵtext(18, \"\\u0412\\u0430\\u0448 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 4);\n        i0.ɵɵelementStart(20, \"input\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function MessageFormComponent_Template_input_ngModelChange_20_listener($event) {\n          return ctx.contact.phoneNumber = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(21, MessageFormComponent_div_21_Template, 2, 0, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 1);\n        i0.ɵɵelementStart(23, \"div\", 2);\n        i0.ɵɵelementStart(24, \"label\", 3);\n        i0.ɵɵtext(25, \"\\u0422\\u0435\\u043C\\u0430:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\", 4);\n        i0.ɵɵelementStart(27, \"select\", 9);\n        i0.ɵɵtemplate(28, MessageFormComponent_option_28_Template, 2, 2, \"option\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 1);\n        i0.ɵɵelementStart(30, \"div\", 2);\n        i0.ɵɵelementStart(31, \"label\", 3);\n        i0.ɵɵtext(32, \"\\u0412\\u0430\\u0448\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"div\", 4);\n        i0.ɵɵelement(34, \"textarea\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(35, MessageFormComponent_div_35_Template, 2, 0, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"div\", 12);\n        i0.ɵɵelementStart(37, \"button\", 13);\n        i0.ɵɵtext(38, \" \\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u0438\\u0441\\u044C\\u043C\\u043E! \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"div\");\n        i0.ɵɵtext(40);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"div\");\n        i0.ɵɵelementStart(42, \"a\", 14);\n        i0.ɵɵtext(43, \"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435 1\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.msgForm);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.contact.name);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.msgForm.controls[\"contactName\"].invalid && ctx.msgForm.controls[\"contactName\"].touched);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.contact.email);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.msgForm.controls[\"contactEmail\"].invalid && ctx.msgForm.controls[\"contactEmail\"].touched);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.contact.phoneNumber);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.msgForm.controls[\"phoneNumber\"].invalid && ctx.msgForm.controls[\"phoneNumber\"].touched);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.topics);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.msgForm.controls[\"message\"].invalid && ctx.msgForm.controls[\"message\"].touched);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.msgForm.invalid);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\\u0418\\u043D\\u0434\\u0435\\u043A\\u0441 \\u043A\\u043E\\u043D\\u0442\\u0430\\u043A\\u0442\\u0430: \", ctx.index, \"\");\n      }\n    },\n    encapsulation: 2\n  });\n  return MessageFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}